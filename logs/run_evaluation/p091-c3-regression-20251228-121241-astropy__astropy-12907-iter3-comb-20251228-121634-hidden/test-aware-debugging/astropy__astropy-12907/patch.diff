--- a/astropy/modeling/tests/test_separable.py
+++ b/astropy/modeling/tests/test_separable.py
@@ -136,6 +136,20 @@
 def test_custom_model_separable():
+
+
+def test_separability_matrix_for_nested_compound_models():
+    cm = models.Linear1D(10) & models.Linear1D(5)
+    expected_matrix_cm = np.array([[True, False],
+                                   [False, True]])
+    assert_allclose(separability_matrix(cm), expected_matrix_cm)
+
+    nested_cm = models.Pix2Sky_TAN() & cm
+    expected_matrix_nested_cm = np.array([[True, True, False, False],
+                                          [True, True, False, False],
+                                          [False, False, True, True],
+                                          [False, False, True, True]])
+    assert_allclose(separability_matrix(nested_cm), expected_matrix_nested_cm)
     @custom_model
     def model_a(x):
         return x

--- a/astropy/modeling/separable.py
+++ b/astropy/modeling/separable.py
@@ -242,7 +242,7 @@
         cright = _coord_matrix(right, 'right', noutp)
     else:
         cright = np.zeros((noutp, right.shape[1]))
-        cright[-right.shape[0]:, -right.shape[1]:] = 1
+cright[-right.shape[0]:, -right.shape[1]:] = right

     return np.hstack([cleft, cright])
