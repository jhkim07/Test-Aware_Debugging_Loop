diff --git a/astropy/modeling/tests/test_separable.py b/astropy/modeling/tests/test_separable.py
--- a/astropy/modeling/tests/test_separable.py
+++ b/astropy/modeling/tests/test_separable.py
@@ -6,4 +6,11 @@
 from astropy.modeling import models as m
 from astropy.modeling.separable import separability_matrix
+import numpy as np

+cm_4d_expected = (np.array([False, False, True, True]),
+                  np.array([[True,  True,  False, False],
+                            [True,  True,  False, False],
+                            [False, False,  True,  True]]))
+
+
 # Existing test cases...

 compound_models = {
@@ -52,10 +59,21 @@
     'cm7': (map2 | p2 & sh1,
             (np.array([False, True]),
              np.array([[True, False], [False, True]]))
-            )
+            ),
+    'cm8': (m.Pix2Sky_TAN() & (m.Linear1D(10) & m.Linear1D(5)), cm_4d_expected),
+    'cm9': (m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5), cm_4d_expected),
+    'cm10': (m.Pix2Sky_TAN() & (m.Linear1D(10) & m.Linear1D(5)), cm_4d_expected),
+    'cm11': (m.Pix2Sky_TAN() & m.Linear1D(10) & (m.Linear1D(5)), cm_4d_expected),
+    'cm12': (m.Pix2Sky_TAN() & (m.Linear1D(10) & (m.Linear1D(5))), cm_4d_expected),
 }

+def test_nested_compound_model_separability():
+    cm = m.Linear1D(10) & m.Linear1D(5)
+    expected = cm_4d_expected[1]
+    result = separability_matrix(m.Pix2Sky_TAN() & cm)
+    assert np.array_equal(result, expected)
+
 # existing tests... 

{
    "public": ["astropy/modeling/tests/test_separable.py::test_nested_compound_model_separability"],
    "hidden": []
}

diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py
--- a/astropy/modeling/separable.py
+++ b/astropy/modeling/separable.py
@@ -242,5 +242,5 @@
         cright = _coord_matrix(right, 'right', noutp)
     else:
         cright = np.zeros((noutp, right.shape[1]))
-        cright[-right.shape[0]:, -right.shape[1]:] = 1
+        cright[-right.shape[0]:, -right.shape[1]:] = right

     return np.hstack([cleft, cright])