{"instance_id": "astropy__astropy-14182", "model_patch": "--- a/astropy/io/ascii/tests/test_rst.py\n+++ b/astropy/io/ascii/tests/test_rst.py\n@@ -2,6 +2,8 @@\n from io import StringIO\n\n+import astropy.units as u\n+from astropy.table import QTable\n from astropy.io import ascii\n\n from .common import assert_almost_equal, assert_equal\n@@ -170,6 +172,21 @@\n dat = ascii.read(table, Reader=ascii.RST)\n\n+def test_rst_with_header_rows():\n+    \"\"\"Test RST table writing with header_rows specified\"\"\"\n+    tbl = QTable({'wave': [350, 950] * u.nm, 'response': [0.7, 1.2] * u.count})\n+    out = StringIO()\n+    tbl.write(out, format='ascii.rst', header_rows=['name', 'unit'])\n+    expected = '''\n+    ======= ========\n+     wave response\n+       nm       ct\n+    ======= ========\n+      350.0      0.7\n+      950.0      1.2\n+    ======= ========\n+    '''\n+    assert_equal_splitlines(out.getvalue(), expected)\n def test_write_normal():\n     \"\"\"Write a table as a normal SimpleRST Table\"\"\"\n     out = StringIO()\n\n--- a/astropy/io/ascii/rst.py\n+++ b/astropy/io/ascii/rst.py\n@@ -27,12 +27,63 @@\n class SimpleRSTData(FixedWidthData):\n+    end_line = -1\n+    splitter_class = FixedWidthTwoLineDataSplitter\n     start_line = 3\n     end_line = -1\n     splitter_class = FixedWidthTwoLineDataSplitter\n\n class RST(FixedWidth):\n+    \"\"\"reStructuredText simple format table.\n+\n+    See: https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html#simple-tables\n+\n+    Example::\n+\n+      >>> from astropy.table import QTable\n+      >>> import astropy.units as u\n+      >>> import sys\n+      >>> tbl = QTable({\"wave\": [350, 950] * u.nm, \"response\": [0.7, 1.2] * u.count})\n+      >>> tbl.write(sys.stdout,  format=\"ascii.rst\")\n+      ===== ========\n+       wave response\n+      ===== ========\n+      350.0      0.7\n+      950.0      1.2\n+      ===== ========\n+\n+    Like other fixed-width formats, when writing a table you can provide ``header_rows``\n+    to specify a list of table rows to output as the header.  For example::\n+\n+      >>> tbl.write(sys.stdout,  format=\"ascii.rst\", header_rows=['name', 'unit'])\n+      ===== ========\n+       wave response\n+         nm       ct\n+      ===== ========\n+      350.0      0.7\n+      950.0      1.2\n+      ===== ========\n+\n+    Currently there is no support for reading tables which utilize continuation lines,\n+    or for ones which define column spans through the use of an additional\n+    line of dashes in the header.\n+\n+    \"\"\"\n+\n+    _format_name = \"rst\"\n+    _description = \"reStructuredText simple table\"\n+    data_class = SimpleRSTData\n+    header_class = SimpleRSTHeader\n+\n+    def __init__(self, header_rows=None):\n+        super().__init__(delimiter_pad=None, bookend=False, header_rows=header_rows)\n+\n+    def write(self, lines):\n+        lines = super().write(lines)\n+        idx = len(self.header.header_rows)\n+        lines = [lines[idx]] + lines + [lines[idx]]\n+        return lines\n     \"\"\"reStructuredText simple format table.\n\n     See: https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html#simple-tables\n", "model_name_or_path": "test-aware-debugging"}
